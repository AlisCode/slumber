environments:
  - id: works
    name: Works
    data:
      host: https://httpbin.org
      user_guid: abc123
      auth_token: eggsalad
  - id: init-fails
    name: Request Init Fails
    data:
      host: http://localhost:5000
  - id: request-fails
    name: Request Fails
    data:
      host: http://localhost:5000
      user_guid: abc123
      auth_token: eggsalad

chains:
  - id: auth_token
    source: login
    expire: never

base: &base
  headers:
    Accept: application/json
    Authorization: Bearer {{chains.auth_token}}
    Content-Type: application/json

requests:
  - id: login
    method: POST
    url: "{{host}}/anything/login"
    body: |
      {
        "username": "user",
        "password": "hunter2"
      }

  - <<: *base
    id: get_users
    name: Get Users
    method: GET
    url: "{{host}}/get"
    query:
      foo: bar

  - <<: *base
    id: get_user
    name: Get User
    method: GET
    url: "{{host}}/anything/{{user_guid}}"

  - <<: *base
    id: modify_user
    name: Modify User
    method: PUT
    url: "{{host}}/anything/{{user_guid}}"
    body: |
      {
        "username": "new username"
      }
